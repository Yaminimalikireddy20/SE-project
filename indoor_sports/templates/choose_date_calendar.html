{% extends "base.html" %}
{% load static %}

{% block title %}Select Date - Indoor Sports{% endblock %}

{% block content %}
<div class="container mt-5">
    <div class="glass-card p-5 rounded-4 shadow">
        <h2 class="text-center mb-4">Select a Date for {{ sport.sport_name }} at {{ location.name }}</h2>

        <!-- Month Navigation -->
        <div class="d-flex justify-content-center mb-4 gap-3">
            <a href="?year={{ year }}&month={% if month == 1 %}12&year={{ year|add:'-1' }}{% else %}{{ month|add:'-1' }}{% endif %}" 
               class="btn btn-primary rounded-pill px-4">
               ← Previous
            </a>
            <a href="?year={{ year }}&month={% if month == 12 %}1&year={{ year|add:'1' }}{% else %}{{ month|add:'1' }}{% endif %}" 
               class="btn btn-primary rounded-pill px-4">
               Next →
            </a>
        </div>

        <!-- Calendar Wrapper -->
        <div class="table-calendar">
            {{ calendar_html|safe }}
        </div>

        <!-- Hidden input to store selected date -->
        <input type="hidden" id="selected_date" name="selected_date">
    </div>
</div>
{% endblock %}

{% block extra_css %}
<link rel="stylesheet" type="text/css" href="{% static 'css/glass.css' %}">
{% endblock %}

{% block extra_js %}
<script>
document.addEventListener("DOMContentLoaded", function () {
    const calendarCells = document.querySelectorAll(".table-calendar td.available");
    const selectedDateInput = document.getElementById("selected_date");

    calendarCells.forEach(cell => {
        cell.addEventListener("click", function () {
            if (!this.classList.contains("unavailable")) {
                document.querySelectorAll(".selected-date").forEach(prev => prev.classList.remove("selected-date"));
                this.classList.add("selected-date");
                selectedDateInput.value = this.dataset.date;
                console.log("Selected Date:", selectedDateInput.value);
            }
        });
    });

    document.querySelectorAll(".month-nav").forEach(button => {
        button.addEventListener("click", function (event) {
            event.preventDefault();
            window.location.href = this.getAttribute("href");
        });
    });
});
</script>
{% endblock %}
